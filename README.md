<p align="center">
  <img src="./Tehranshomallogo.png" alt="Islamic Azad University North Tehran Branch" width="150"/>
</p>

<h1 align="center">COVID-SegNet: Encoder–Decoder-Based Architecture for COVID-19 Lesion Segmentation in Chest X-Ray</h1>

<p align="center">
  پروژهٔ درس <strong>یادگیری ماشین</strong><br>
  دانشگاه آزاد اسلامی، واحد تهران شمال<br>
  استاد: <strong>دکتر ملیحه ثابتی</strong>
</p>

---

## 📄 معرفی پروژه

این پروژه به پیاده‌سازی مقاله‌ای تحت عنوان زیر اختصاص دارد:

> COVID-SegNet: Encoder–Decoder-Based Architecture for COVID-19 Lesion Segmentation in Chest X-Ray

این مقاله یک معماری نوین برای **تقسیم‌بندی نواحی آلوده به کووید-۱۹ در تصاویر اشعه ایکس قفسه سینه (CXR)** معرفی می‌کند. معماری پیشنهادی بر پایه مدل UNet طراحی شده است و با استفاده از ماژول‌های توجه (Attention) و Atrous Spatial Pyramid Pooling (ASPP) تقویت شده است.

---

## 🗂 دیتاست

برای آموزش و ارزیابی مدل، از دیتاست **QaTa-COV19** استفاده شده است. این دیتاست شامل ۲۹۵۱ تصویر اشعه ایکس همراه با ماسک‌های Ground Truth برای نواحی آلوده به کووید-۱۹ می‌باشد.

📥 آدرس دیتاست:  
[https://www.kaggle.com/datasets/aysendegerli/qatacov19-dataset](https://www.kaggle.com/datasets/aysendegerli/qatacov19-dataset)

---

## 🧠 روش کار

### مراحل اجرا:
1. **نصب کتابخانه‌ها**:
   - با استفاده از Jupyter Notebook، کتابخانه‌های `kagglehub`, `kaggle`, `pillow`, `numpy`, و `pandas` نصب شدند.
2. **تنظیم فایل `kaggle.json`**:
   - مسیر فایل `kaggle.json` جهت دانلود دیتاست از Kaggle تنظیم شد.
   - از `KaggleApi` برای احراز هویت و دانلود مستقیم دیتاست استفاده شد.
3. **لود دیتاست**:
   - تصاویر آموزشی و تست از پوشه‌های مشخص بارگذاری شدند.
   - ماسک‌های Ground Truth مرتبط با تصاویر نیز بارگذاری و بررسی شدند.
4. **پیش‌پردازش تصاویر**:
   - تغییر اندازه تصاویر به ابعاد `(224, 224)`.
   - نرمال‌سازی داده‌ها برای آماده‌سازی جهت آموزش مدل.
   - ماسک‌ها به صورت باینری تبدیل شدند و برای آموزش مدل آماده شدند.
5. **نمایش داده‌ها**:
   - نمونه‌هایی از تصاویر و ماسک‌ها با استفاده از `Matplotlib` برای بررسی بصری نمایش داده شدند.
6. **مدل‌سازی**:
   - استفاده از معماری پایه UNet برای تفکیک نواحی آلوده.
   - افزودن مکانیزم‌های توجه scSE Attention (channel + spatial attention).
   - تقویت مدل با ماژول ASPP با نرخ‌های گسترش ۲، ۳، ۴.
7. **آموزش مدل**:
   - آموزش مدل بر روی Google Colab با GPU نوع P100.
   - استفاده از تکنیک 5-Fold Cross-Validation برای ارزیابی عملکرد مدل.

---

## 🛠 تنظیمات اجرا

| پارامتر                 | مقدار                           |
|-------------------------|---------------------------------|
| زبان برنامه‌نویسی       | Python                         |
| کتابخانه‌های مورد استفاده| TensorFlow / Keras, KaggleHub, OpenCV, Matplotlib, tqdm |
| تعداد epoch             | 200                            |
| Batch size              | 4                              |
| Optimizer               | Adam (lr=0.0005)               |
| Loss function           | Dice Loss                      |
| ابعاد ورودی تصاویر      | (224, 224)                     |

---

## 📊 نتایج به‌دست‌آمده

| بخش                       | مقدار                           |
|---------------------------|---------------------------------|
| تعداد تصاویر مجموعه آموزش | 7145                           |
| تعداد تصاویر مجموعه تست   | 2113                           |
| Dice Score میانگین        | 0.8325                         |
| Jaccard Index میانگین     | 0.7132                         |

---

## 📌 نکات تکمیلی

- مدل دارای حدود ۶.۵ میلیون پارامتر است که نسبت به مدل‌های پیچیده‌تر مانند Inception-v3 بسیار سبک‌تر است.
- تصاویر خروجی به‌صورت کیفی نشان‌دهنده عملکرد مناسب مدل در نواحی آلوده شدید، متوسط و خفیف هستند.
- این پروژه صرفاً جهت آموزش و ارائه در درس یادگیری ماشین تهیه شده است.

---

## 📚 منابع

- [مقاله اصلی - Springer](https://doi.org/10.1007/s00530-023-01096-9)
- [دیتاست QaTa-COV19 - Kaggle](https://www.kaggle.com/datasets/aysendegerli/qatacov19-dataset)

---

<p align="center"><i>این پروژه با هدف آموزش و افزایش توانمندی دانشجویان در اصول مدل‌سازی و یادگیری ماشین ارائه شده است.</i></p>
